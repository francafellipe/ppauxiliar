<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <title>Dashboard </title>
  <style>
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
      font-family: Arial, sans-serif;
      background-color: #f8f9fa;
    }

    .content {
      padding: 1rem;
      margin-top: 60px;
      padding-top: 20px;
    }

    .content-container {
      text-align:center;
      display: none;
      overflow-y: auto;
    }

    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: #343a40;
      color: white;
      padding: 0.5rem 1rem;
      z-index: 1000;
    }

    .planilha-table {
      width: 100%;
      margin-top: 1rem;
      background-color: white;
      border: 1px solid #dee2e6;
    }

    .planilha-table th,
    .planilha-table td {
      padding: 0.5rem;
      text-align: center;
    }

    .list-group-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .list-group-item img {
      max-width: 95%;
      height: auto;
    }

    .list-group-item p {
      margin-top: 0.5rem;
    }

    @media (max-width: 768px) {
      .list-group-item {
        margin-bottom: 10px;
      }

      .content-container {
        max-height: 90vh;
      }
    }

    @media (min-width: 768px) {
      .list-group {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }

      .content-container {
        max-height: 85vh;
      }
    }
  </style>
</head>

<body>
  <header class="header">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Manual Consinco</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
          aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <button class="btn btn-primary nav-link" onclick="mostrarConteudo('conferencia-quebra')">Conferência
                quebra</button>
            </li>
            <li class="nav-item">
              <button class="btn btn-primary nav-link" onclick="mostrarConteudo('relatorio-quebra')">Relatório
                Quebra</button>
            </li>
            <li class="nav-item">
              <button class="btn btn-primary nav-link" onclick="mostrarConteudo('estoque-cigarros')">Estoque
                Cigarros</button>
            </li>
            <li class="nav-item">
              <button class="btn btn-primary nav-link" onclick="mostrarConteudo('estoque-par')">Estoque P.A.R</button>
            </li>
            <li class="nav-item">
              <button class="btn btn-primary nav-link disabled" onclick="mostrarConteudo('planilha')">Exibir Planilha
                Atualizada</button>
            </li>
            <li class="nav-item">
              <button class="btn btn-danger nav-link" onclick="logout()">Sair</button>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <div class="content">
    <div class="content-container" id="conferencia-quebra">
      <h2>Conferência de Quebra</h2>
      <h3>Passo a passo para Conferir os Itens Lançados nas CGO's de Quebra</h3>
      <ol class="list-group">
        <li class="list-group-item">1 Acesso ao Sistema: Faça login no sistema utilizando suas credenciais de usuário.
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/1perdas.jpeg" alt="Imagem 1">
          <p>2 ACESSE COMERCIAL - GERENCIAL</p>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/2perdas.jpeg" alt="Imagem 2">
          <p>3 - CLIQUE EM ANÁLISE ABC DE PERDAS</p>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/1.5perdas.jpeg" alt="Imagem 1.5">
          <p>4 - Na tela inicial da Análise ABC de perdas selecine filtro </p>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/3perdas.jpeg" alt="Imagem 3">
          <p>5 - Seleção da Opção de CGO: selecione a opção ou menu específico para CGO's de quebra.</p>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/4perdas.jpeg" alt="Imagem 4">
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/5perdas.jpeg" alt="Imagem 5">
          <p>7 - Marque somente os CGO`s escolhidos uma vez aplicado a seleção, selecione escolher CGOS e você verá uma
            lista de todas as CGO's.</p>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/6perdas.jpeg" alt="Imagem 6">
          <p>8 - Detalhes dos CGO`S: Clique em cada CGO de quebra para visualizar os itens lançados. Selecione somente
            as CGO`S 549, 567 E 555</p>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/7perdas.jpeg" alt="Imagem 7">
          <p>9 - Filtragem por Data: Utilize os filtros disponíveis para selecionar o período de datas que deseja
            conferir. Isso pode incluir a data de início e fim do período de lançamento dos produtos, filtro por sessão
            , categoria etc..</p>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/8perdas.jpeg" alt="Imagem 8">
          <p>10 - Selecione os detalhes que serão exibidos na planilha</p>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferencia quebra/10perdas.jpeg" alt="Imagem 10">
          <p>11 - Ao apertar F8 ou clicar para buscar , sua tela ficara parecido com está, o valor do seu quebra de cada
            produto está na coluna - Tot Perda Bruto - o valor total da somatoria aparece abaixo </p>
        </li>
      </ol>
    </div>
    <div class="content-container" id="relatorio-quebra">
      <h2>Relatório de Quebra</h2>
      <h3>Imprimir relátorio de Avarias </h3>
      <ol class="list-group">
        <li class="list-group-item"><h4>1 - Acesso ao Sistema: Faça login no sistema utilizando suas credenciais de usuário.</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/Imprimir relatorio de quebra/imprimirrelatorio1.jpeg" alt="Imagem 1">
          <h4>2 - ACESSE COMERCIAL - Estoque</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/Imprimir relatorio de quebra/imprimirrelatorio2.jpeg" alt="Imagem 2">
          <h4>3 - CLIQUE EM VAREJO</h4>
        </li>
        </li>
        <li class="list-group-item">
          <img src="./imagens/Imprimir relatorio de quebra/3.jpeg" alt="Imagem 4">
          <h4>Clique em Controle de Avaria. Após isso, clique em Rel. Posição de Avaria do fornecedor/Comprador.</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/Imprimir relatorio de quebra/3.5.jpeg" alt="Imagem 5">
          <h4>Irá abrir esta tela, onde você pode selecionar por período, comprador, fornecedor, qual o tipo de avaria,
            tipo de quebra do relatório (como deve ser exibido o relatório).</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/Imprimir relatorio de quebra/4.jpeg" alt="Imagem 6">
          <h4>Escolha o período, filtre o comprador e o tipo de avaria. Por exemplo, na imagem faremos do setor FLV.</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/Imprimir relatorio de quebra/5.jpeg" alt="Imagem 7">
          <h4>Tipo de avaria de FLV é sem indenização, que são produtos que vão diretamente para o quebra sem passar pelo
            depósito de trocas.</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/Imprimir relatorio de quebra/6.jpeg" alt="Imagem 8">
          <h4>Ao escolher os filtros, selecione a impressora no topo da tela para visualizar o relatório e imprimir após
            isso.</h4>
        </li>
        <li class="list-group-item">
          <img src="../imagens/Imprimir relatorio de quebra/7.jpeg" alt="Imagem 10">
          <h4>Assim será exibido o relatório.</h4>
        </li>
      </ol>
    </div>
    <div class="content-container" id="estoque-cigarros">
      <h2>Estoque Cigarros</h2>
      <h3>Como conferir estoque de cigarros.</h3>
      <ol class="list-group">
        <li class="list-group-item">
          <h4>1-Acesso ao sistema : Faça login no sistema utilizando as suas credenciais de acesso </h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque cigarros/1.jpeg" alt="imagem1">
          <h4>Comercial -> Estoque</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque cigarros/2.jpeg" alt="imagem2">
          <h4> Clique em Atacado/Varejo</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque cigarros/3.jpeg" alt="imagem2">
          <h4>Clique em Rel- Geral do Estoque</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque cigarros/4.jpeg" alt="imagem2">
          <h4>Ao abrir esta tela selecione categorias</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque cigarros/5.jpeg" alt="imagem2">
          <h4>Marque somente as opçoes bazar/tabacaria/cigarros/cigarros</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque cigarros/6.jpeg" alt="imagem2">
          <h4>Selecione Apenas Itens com Estoque nas opçoes, e depois clique na impressora no topo da tela </h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque cigarros/7.jpeg" alt="imagem7">
          <h4>Nesta tela aparecerá o estoque de cigarros que possuem estoque.</h4>
        </li>
      </ol>
    </div>
    <div class="content-container" id="estoque-par">
      <h2>Estoque P.A.R</h2>
      <h3>Como realizar a conferência de estoque de itens do P.A.R
      </h3>
      <ol class="list-group">
        <li class="list-group-item">
          <h4>Acesso ao Sistema: Faça login no sistema utilizando suas credenciais de usuário.</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque de P.A/conf1.jpeg" alt="img1">
          <h4>COMERCIAL / ESTOQUE</h4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque de P.A/conf2.jpeg" alt="img1">
          <H4>Caso não saiba o codigo, clique em Produto e faça a pesquisa, caso tenha o codigo basta digitar o codigo do produto e pressionar <strong>F8</strong> </H4>
        </li>
        <li class="list-group-item">
          <img src="./imagens/conferir estoque de P.A/conf3.jpeg" alt="img1">
          <h4>No exemplo estamos utilizando o Codigo do red Label : 12747 </h4>
        </li>
      </ol>
    </div>
    <div class="content-container" id="planilha">
      <h2>Atualizar Planilha</h2>
      <form id="form-planilha">
        <div class="form-group">
          <label for="data">Data:</label>
          <input type="text" id="data" name="data" class="form-control" placeholder="dd/mm/aaaa" required>
        </div>
        <div class="form-group">
          <label for="valor-venda">Valor da Venda:</label>
          <input type="text" id="valor-venda" name="valor-venda" class="form-control" required>
        </div>
        <div class="form-group">
          <label for="valor-quebra">Valor da Quebra:</label>
          <input type="text" id="valor-quebra" name="valor-quebra" class="form-control" required>
        </div>
        <button type="button" class="btn btn-primary">Enviar</button>
      </form>

      <table class="table planilha-table">
        <thead>
          <tr>
            <th>Data</th>
            <th>Venda Atual R$</th>
            <th>Meta R$</th>
            <th>Meta %</th>
            <th>Quebra Atual R$</th>
            <th>Meta Quebra R$</th>
            <th>Meta %</th>
            <th>Quebra Atual %</th>
          </tr>
        </thead>
        <tbody id="planilha-body">
          <!-- Aqui serão inseridas as linhas dinamicamente -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    const urlSheets = 'https://script.google.com/macros/s/AKfycbxMdzBAN09AWj5o6Ptsn3oJoiTp_fFrl9avmUGBYgTy4JZvjFP-LdvqoZgJKhbvRB9S/exec'
    document.addEventListener('DOMContentLoaded', function () {
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      if (!currentUser) {
        window.location.href = 'login.html'; // Redireciona para login se não estiver autenticado
      }
      carregarDadosPlanilha();
    });

    function carregarDadosPlanilha() {
      const currentUser = JSON.parse(localStorage.getItem('currentUser'));
      const dadosSalvos = JSON.parse(localStorage.getItem(`dadosPlanilha_${currentUser.username}`)) || [];

      const tbody = document.getElementById('planilha-body');
      tbody.innerHTML = '';

      dadosSalvos.forEach(dados => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${dados.data}</td>
          <td>${dados.valorVenda}</td>
          <td>R$ 95.161,29</td>
          <td>92,78%</td>
          <td>${dados.valorQuebra}</td>
          <td>R$ 1.094,35</td>
          <td>1,15%</td>
          <td>0,30%</td>
        `;
        tbody.appendChild(row);
      });
    }

    document.querySelector("#form-planilha button").addEventListener("click", function () {
      const data = document.querySelector("#data").value;
      const valorVenda = document.querySelector("#valor-venda").value;
      const valorQuebra = document.querySelector("#valor-quebra").value;

      if (!data || !valorVenda || !valorQuebra) {
        alert("Preencha todos os campos!");
        return;
      }

      const novoDado = {
        data: data,
        valorVenda: valorVenda,
        valorQuebra: valorQuebra
      };

      fetch(urlSheets, {
        method: 'POST',
        body: JSON.stringify(novoDado),
        headers: {
          'Content-Type': 'application/json'
        }
      })
        .then(response => response.json())
        .then(data => {
          console.log('Success:', data);
          carregarDadosPlanilha();
          document.querySelector("#form-planilha").reset();
        })
        .catch((error) => {
          console.error('Error:', error);
        });
    });

    function mostrarConteudo(id) {
      const containers = document.querySelectorAll(".content-container");
      containers.forEach(container => container.style.display = "none");

      const containerToShow = document.getElementById(id);
      if (containerToShow) {
        containerToShow.style.display = "block";
        const navbarToggler = document.querySelector(".navbar-toggler");
        if (navbarToggler.offsetParent !== null) {
          navbarToggler.click();
        }
      }
    }

    function logout() {
      localStorage.removeItem('currentUser');
      window.location.href = 'login.html';
    }

    function formatarValor(valor) {
      if (valor) {
        valor = valor.replace(/[.,]/g, '');
        const partes = valor.split('.');
        if (partes.length > 1) {
          partes[0] = partes[0].replace(/\B(?=(\d{3})+(?!\d))/g, '.');
          valor = partes.join(',');
        }
        valor = valor.replace(/,/g, '.');
        if (!valor.startsWith('R$')) {
          valor = 'R$ ' + valor;
        }
      }
      return valor;
    }

    const inputQuebra = document.getElementById('valor-quebra');
    inputQuebra.addEventListener('input', function () {
      inputQuebra.value = formatarValor(inputQuebra.value);
    });

    const inputVenda = document.getElementById('valor-venda');
    inputVenda.addEventListener('input', function () {
      inputVenda.value = formatarValor(inputVenda.value);
    });

    const inputData = document.getElementById('data');
    inputData.addEventListener('input', function () {
      let value = inputData.value;
      value = value.replace(/\D/g, '');
      if (value.length > 8) {
        value = value.substr(0, 8);
      }
      if (value.length > 4) {
        value = value.replace(/^(\d{2})(\d{2})(\d{4})$/, '$1/$2/$3');
      } else if (value.length > 2) {
        value = value.replace(/^(\d{2})(\d{2})$/, '$1/$2');
      }
      inputData.value = value;
    });

  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
</body>

</html>
